var P=Object.defineProperty;var f=(a,s,t)=>s in a?P(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var b=(a,s,t)=>(f(a,typeof s!="symbol"?s+"":s,t),t);import{u as i,j as o,r as x}from"./index-197b23cf.js";import{c as g,u as k,b as j,a as N,P as O}from"./redux-toolkit.esm-f09c1c23.js";import{D as S}from"./displayBox-24a01835.js";const l=class l{static isOperatorChar(s){return i.isStr(s)&&new RegExp(`[${l.FUNC_KEYS}]`).test(s)}static isValidOperatorCombination(s,t){const e=s+t;return i.isStr(e)&&/(:?[/x-]-)/.test(e)}static isNumberChar(s){return i.isStr(s)&&/[0-9.]/.test(s)}static isValidStartChar(s){return i.isStr(s)&&/[1-9.-]/.test(s)}static isEqualChar(s){return i.isStr(s)&&s==="="}static isValidCalc(s){return i.isStr(s)&&/^(-?[0-9]+(:?[.][0-9]+)?[/x+-]-?[0-9]+(:?[.][0-9]+)?)+$/.test(s)}static hasDecimalOnLastNumber(s){return/[0-9]+\.(?:[0-9]+)?$/.test(s)}static setNewOutput(s,t){let e=s==="0"?"0":s;if(i.isStrNotEmpty(e)){const r=[...e],d=r.length,c=r[d-1],n=l.isOperatorChar(t);n&&l.isOperatorChar(c)&&!l.isValidOperatorCombination(c,t)?(d-2>0&&l.isOperatorChar(r[d-2])&&r.pop(),r.pop(),r.push(t),e=r.join("")):n?(r.push(t),e=r.join("")):t==="0"&&s==="0"?e="0":t==="."&&l.hasDecimalOnLastNumber(s)?e=r.join(""):t==="."&&s==="0"?e="0.":l.isNumberChar(t)&&(s==="0"&&r.pop(),r.push(t),e=r.join(""))}else l.isValidStartChar(t)?e=t:e="0";return e}static getMatchedValues(s,t,e){if(i.isStrNotEmpty(t)&&i.isValidRegex(s)){const r=t.match(s);if(i.isArray(r)&&r.length-1===e){const d=r.filter((c,n)=>{if(n>0)return c});return t=t.substring(r[0].length,t.length),{text:t,parsed:d}}}return null}static parseCalc(s){let t=[],e,r=s,d=0;const c=100,n=/^(?<number>-?[0-9]+(?:\.?[0-9]+)?)(?<operator>[/x+-])(-?[0-9]+(?:\.?[0-9]+)?)/,u=/^(?<operator>[/x+-])(-?[0-9]+(?:\.?[0-9]+)?)/;for(e=l.getMatchedValues(n,r,3),i.isObject(e)&&(t=e.parsed,r=e.text);r.length>0&&d<c;){if(e=l.getMatchedValues(u,r,2),i.isObject(e))t=t.concat(e.parsed),r=e.text;else{r="",t=null;break}d++}return t}static getCalcResult(s,t,e){switch(t){case"+":return s+e;case"-":return s-e;case"x":return s*e;case"/":return s/e;default:return null}}static parseNumbersFromArray(s){return s.map((t,e)=>e%2===0?t.includes(".")?parseFloat(t):parseInt(t):t)}static calcFirstResult(s){let t=[...s];const e=l.getCalcResult(s[0],s[1],s[2]);return t=t.splice(2),t[0]=e,t}static getResult(s){const t=l.parseCalc(s);if(i.isArray(t)){let e=l.parseNumbersFromArray(t);for(;e.length>1;)if(e.length>=3)e=l.calcFirstResult(e);else{e=[];break}return e=e.length===1?""+e[0]:"0",e}return null}};b(l,"FUNC_KEYS","/x\\-+="),b(l,"OPERATION_KEYS","/x\\-+");let p=l;const h=g({name:"jsCalc",initialState:{lastKey:"",history:[],output:"0"},reducers:{clearDisplay(a){a.history=[],a.output="0",a.lastKey=""},delKey(a){i.isStr(a.output)&&a.output.length>1?a.output=a.output.slice(0,-1):a.output="0"},addKey(a,s){const t=s.payload;if(p.isEqualChar(t)){const e=p.getResult(a.output);i.isStr(e)&&(a.history.push(`${a.output} = ${e}`),a.output=e)}else["Infinity","NaN"].includes(a.output)&&(a.output="0"),a.output=p.setNewOutput(a.output,t)},setOutput(a,s){a.output=s.payload,a.lastKey=""},setHistory:{reducer(a,s){a.history=s.payload.history,a.output=s.payload.output},prepare(a){return{inputValue:a,output:a}}}}}),{clearDisplay:E,addKey:w,setOutput:Y,setHistory:U,delKey:R}=h.actions,K=a=>a.jsCalc.output,V=h.reducer;function D(){const a=k(K);return o.jsx("div",{className:"calc-display",children:o.jsx(S,{displayMsg:a,itemId:"display",itemClass:"display-box"})})}const m=[{containerClass:"js-calc-row",pads:[{idPad:"del",iconClass:"fas fa-backspace",dataCalc:"Del",keyPress:"Backspace",calcClass:"btn-secondary"},{idPad:"clear",text:"Ac",dataCalc:"Ac",keyPress:"Escape",calcClass:"btn-danger"}]},{containerClass:"js-calc-row",pads:[{idPad:"seven",text:"7",dataCalc:"7",keyPress:"7",calcClass:"btn-secondary btn-number"},{idPad:"eight",text:"8",dataCalc:"8",keyPress:"8",calcClass:"btn-secondary btn-number"},{idPad:"nine",text:"9",dataCalc:"9",keyPress:"9",calcClass:"btn-secondary btn-number"},{idPad:"divide",text:"/",dataCalc:"/",keyPress:"/",calcClass:"btn-secondary"},{idPad:"multiply",text:"x",dataCalc:"x",keyPress:"*",calcClass:"btn-secondary"}]},{containerClass:"js-calc-row",pads:[{idPad:"four",text:"4",dataCalc:"4",keyPress:"4",calcClass:"btn-secondary btn-number"},{idPad:"five",text:"5",dataCalc:"5",keyPress:"5",calcClass:"btn-secondary btn-number"},{idPad:"six",text:"6",dataCalc:"6",keyPress:"6",calcClass:"btn-secondary btn-number"},{idPad:"subtract",text:"-",dataCalc:"-",keyPress:"-",calcClass:"btn-secondary"},{idPad:"add",text:"+",dataCalc:"+",keyPress:"+",calcClass:"btn-secondary"}]},{containerClass:"js-calc-row",pads:[{idPad:"one",text:"1",dataCalc:"1",keyPress:"1",calcClass:"btn-secondary btn-number"},{idPad:"two",text:"2",dataCalc:"2",keyPress:"2",calcClass:"btn-secondary btn-number"},{idPad:"three",text:"3",dataCalc:"3",keyPress:"3",calcClass:"btn-secondary btn-number"},{idPad:"equals",text:"=",dataCalc:"=",keyPress:"Enter",calcClass:"btn-secondary"}]},{containerClass:"js-calc-row",pads:[{idPad:"zero",text:"0",dataCalc:"0",keyPress:"0",calcClass:"btn-secondary btn-number"},{idPad:"decimal",text:".",dataCalc:".",keyPress:".",calcClass:"btn-secondary btn-number"}]}],M=m.reduce((a,s)=>{const t=s.pads.reduce((e,r)=>(i.isStrNotEmpty(r.keyPress)&&e.push({idPad:r.idPad,keyPress:r.keyPress,dataCalc:r.dataCalc}),e),[]);return a=a.concat(t),a},[]);function F(){const a=j();x.useEffect(()=>(document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}),[]);const s=c=>{switch(c){case"Ac":a(E());break;case"Del":a(R());break;default:a(w(c));break}},t=c=>{const n=i.isStr(c.key)?c.key:null;console.log(`Key pressed ${n}`);const u=M.filter(C=>{if(C.keyPress===n)return C});u.length===1&&(console.log("Object filtered :"),console.log(u),s(u[0].dataCalc))},e=c=>{const n=c.target.getAttribute("data-func");s(n)},r=c=>c.map((n,u)=>{const C=y=>i.isStr(y.iconClass)?o.jsx("i",{className:y.iconClass}):y.text;return o.jsx("button",{id:n.idPad,className:`btn ${n.calcClass}`,"data-func":n.dataCalc,onClick:e,children:C(n)},u)}),d=m.map((c,n)=>o.jsx("div",{className:c.containerClass,children:r(c.pads)},n));return o.jsx("div",{className:"js-calc-pads",children:d})}function $(){return o.jsxs("div",{className:"js-calc-main",children:[o.jsx("div",{className:"js-calc-head",children:"M8 Calculator"}),o.jsx(D,{}),o.jsx(F,{})]})}const L=N({reducer:{jsCalc:V}});function z(){return o.jsx(O,{store:L,children:o.jsx("section",{id:"js-calc",className:"container-fluid",children:o.jsx($,{})})})}export{z as default};
